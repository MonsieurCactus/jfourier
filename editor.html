<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <title>Math Blog Editor</title>
        <link rel="shortcut icon" href="lib/img/tiles.png" type="image/png"/>
        <script src="lib/js/jquery-1.6.3.min.js" type="text/javascript"></script>
        <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="lib/js/showdown.min.js"></script>
        <script src="lib/js/codemirror.js"></script>
        <script src="lib/js/markdown.js"></script>
        <link href="lib/css/codemirror.css" rel="stylesheet">

        <style type='text/css'>
            html, body{
              height:100%;
              margin: 0;
                padding: 0;
            }
        	body {
                font-family: 'New York', 'MS Serif', Georgia, serif;                
            }
            #MathInput {
                height:100%;
                -moz-box-sizing: border-box; 
                -webkit-box-sizing: border-box;     
                box-sizing: border-box;
                width: calc(50% - 20px);
                width: -moz-calc(50% - 20px);
                width: -webkit-calc(50% - 20px);
                width: -o-calc(50% - 20px);
                position: fixed;
                outline: 1px solid #D3D7DC;
                position: fixed;
                top: 0;
                left: 0;
                padding: 10px;
                background-color: #EAEDF1;
            }

            h1, h2, h3, h4, h5{
                font-weight: normal;
            }

            hr {
                border: 1px solid #D3D7DC;
                border-bottom:0;
            }

            #MathInput .header h1{
                font-family: 'avenir', helvetica, sans-serif;
                font-size: 20px;
                font-weight: 300;
                color: #767b8d;
                text-align: center;
            }
            #MathInput .header h1 small{
                font-size: 14px;
                color: #767b8d;
            }

            #MathOutput{
                border-radius: 0px;
                height: auto;
                position: absolute;
                right: 0;
                padding: 10px 20px;
                margin-left: 0px;
                width: calc(50%);
                width: -moz-calc(50%);
                width: -webkit-calc(50%);
                width: -o-calc(50%);
                -moz-box-sizing: border-box; 
                -webkit-box-sizing: border-box;     
                box-sizing: border-box; 
                background-color: #fff;
            }

            .CodeMirror {
                border-radius: 4px;
                height:auto;
            }
        </style>

    </head>

    <body>
        <div id="MathInput">
            <div class="header">
                <h1>
                    JFourier Editor<br/>
                    <small>Type your latex below, see the formatted output on the right!</small>
                </h1>
            </div>

            <form>
            <textarea name="code" id="code">
# Let's write some math!

---

## Latex enabled Editor

This is a LaTeX enabled text editor that lets you write math formulas. 

$ \frac{2}{3}$


            </textarea>
            </form>
        </div>
        <div id="MathOutput"></div>
        <div style="clear:both"></div>
    </body>
    <script type='text/javascript'>//<![CDATA[

        $(document).ready(function(){

            t = document.getElementById('code');
            var delay;
            var editor = CodeMirror.fromTextArea(document.getElementById('code'), {
                lineNumbers: true,
                lineWrapping: true,
                fixedGutter: true,
                gutter: true,
                mode: 'markdown',
                tabMode: 'indent',
                keyMap: 'default',
            });
            editor.on("change", function() {
                clearTimeout(delay);
                delay = setTimeout(updatePreview, 300);
            });

            updatePreview();

            function updatePreview() {
                console.log("test change");  
                var converter = new Showdown.converter();
                var TeX = editor.getValue();
                document.getElementById("MathOutput").innerHTML = converter.makeHtml(TeX);
                //reprocess the MathOutput Element
                MathJax.Hub.Queue(["Typeset",MathJax.Hub,"MathOutput"]);
            }        
        
        });//]]>

    </script>

    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']]}
    });
    </script> 
</html>
